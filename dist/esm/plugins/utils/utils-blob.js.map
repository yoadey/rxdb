{"version":3,"file":"utils-blob.js","names":["arrayBufferToBase64","createBlob","data","type","blob","Blob","createBlobFromBase64","base64String","base64Response","fetch","blobToString","blobType","Object","prototype","toString","call","Promise","resolve","text","blobToBase64String","arrayBuffer","getBlobSize","size"],"sources":["../../../../src/plugins/utils/utils-blob.ts"],"sourcesContent":["import { arrayBufferToBase64 } from './utils-base64.ts';\n\n/**\n * Since RxDB 13.0.0 we only use Blob instead of falling back to Buffer,\n * because Node.js >18 supports Blobs anyway.\n */\n/**\n * depending if we are on node or browser,\n * we have to use Buffer(node) or Blob(browser)\n */\nexport function createBlob(\n    data: string,\n    type: string\n): Blob {\n    const blob = new Blob([data], {\n        type\n    });\n    return blob;\n}\n\nexport async function createBlobFromBase64(\n    base64String: string,\n    type: string\n): Promise<Blob> {\n    const base64Response = await fetch(`data:${type};base64,${base64String}`);\n    const blob = await base64Response.blob();\n    return blob;\n}\n\nexport function blobToString(blob: Blob | string): Promise<string> {\n    /**\n     * in the electron-renderer we have a typed array instead of a blob\n     * so we have to transform it.\n     * @link https://github.com/pubkey/rxdb/issues/1371\n     */\n    const blobType = Object.prototype.toString.call(blob);\n    if (blobType === '[object Uint8Array]') {\n        blob = new Blob([blob]);\n    }\n    if (typeof blob === 'string') {\n        return Promise.resolve(blob);\n    }\n\n    return blob.text();\n}\n\nexport async function blobToBase64String(blob: Blob | string): Promise<string> {\n    if (typeof blob === 'string') {\n        return blob;\n    }\n\n    /**\n     * in the electron-renderer we have a typed array instead of a blob\n     * so we have to transform it.\n     * @link https://github.com/pubkey/rxdb/issues/1371\n     */\n    const blobType = Object.prototype.toString.call(blob);\n    if (blobType === '[object Uint8Array]') {\n        blob = new Blob([blob]);\n    }\n\n    const arrayBuffer = await blob.arrayBuffer();\n    return arrayBufferToBase64(arrayBuffer);\n}\n\nexport function getBlobSize(blob: Blob): number {\n    return blob.size;\n}\n"],"mappings":"AAAA,SAASA,mBAAmB,QAAQ,mBAAmB;;AAEvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,UAAUA,CACtBC,IAAY,EACZC,IAAY,EACR;EACJ,IAAMC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACH,IAAI,CAAC,EAAE;IAC1BC;EACJ,CAAC,CAAC;EACF,OAAOC,IAAI;AACf;AAEA,OAAO,eAAeE,oBAAoBA,CACtCC,YAAoB,EACpBJ,IAAY,EACC;EACb,IAAMK,cAAc,GAAG,MAAMC,KAAK,WAASN,IAAI,gBAAWI,YAAc,CAAC;EACzE,IAAMH,IAAI,GAAG,MAAMI,cAAc,CAACJ,IAAI,CAAC,CAAC;EACxC,OAAOA,IAAI;AACf;AAEA,OAAO,SAASM,YAAYA,CAACN,IAAmB,EAAmB;EAC/D;AACJ;AACA;AACA;AACA;EACI,IAAMO,QAAQ,GAAGC,MAAM,CAACC,SAAS,CAACC,QAAQ,CAACC,IAAI,CAACX,IAAI,CAAC;EACrD,IAAIO,QAAQ,KAAK,qBAAqB,EAAE;IACpCP,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACD,IAAI,CAAC,CAAC;EAC3B;EACA,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;IAC1B,OAAOY,OAAO,CAACC,OAAO,CAACb,IAAI,CAAC;EAChC;EAEA,OAAOA,IAAI,CAACc,IAAI,CAAC,CAAC;AACtB;AAEA,OAAO,eAAeC,kBAAkBA,CAACf,IAAmB,EAAmB;EAC3E,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;IAC1B,OAAOA,IAAI;EACf;;EAEA;AACJ;AACA;AACA;AACA;EACI,IAAMO,QAAQ,GAAGC,MAAM,CAACC,SAAS,CAACC,QAAQ,CAACC,IAAI,CAACX,IAAI,CAAC;EACrD,IAAIO,QAAQ,KAAK,qBAAqB,EAAE;IACpCP,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACD,IAAI,CAAC,CAAC;EAC3B;EAEA,IAAMgB,WAAW,GAAG,MAAMhB,IAAI,CAACgB,WAAW,CAAC,CAAC;EAC5C,OAAOpB,mBAAmB,CAACoB,WAAW,CAAC;AAC3C;AAEA,OAAO,SAASC,WAAWA,CAACjB,IAAU,EAAU;EAC5C,OAAOA,IAAI,CAACkB,IAAI;AACpB","ignoreList":[]}