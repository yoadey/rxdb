{"version":3,"file":"conflict-handling.d.js","names":[],"sources":["../../../src/types/conflict-handling.d.ts"],"sourcesContent":["import type { WithDeleted } from './rx-storage.d.ts';\n\n/**\n * Notice that the conflict handler input/output\n * does not work on RxDocumentData<RxDocType>, but only on WithDeleted<RxDocType>.\n * This is because the _meta attributes are meant for the local storing of document data, they not replicated\n * and therefore cannot be used to resolve conflicts.\n */\nexport type RxConflictHandlerInput<RxDocType> = {\n    assumedMasterState?: WithDeleted<RxDocType>;\n    realMasterState: WithDeleted<RxDocType>;\n    newDocumentState: WithDeleted<RxDocType>;\n};\n\n/**\n * The conflict handler either returns:\n * - The resolved new document state\n * - A flag to identify the given 'realMasterState' and 'newDocumentState'\n *   as being exactly equal, so no conflict has to be resolved.\n */\nexport type RxConflictHandlerOutput<RxDocType> = {\n    isEqual: false;\n    documentData: WithDeleted<RxDocType>;\n} | {\n    isEqual: true;\n};\n\nexport type RxConflictHandler<RxDocType> = (\n    i: RxConflictHandlerInput<RxDocType>,\n    context: string\n) => Promise<RxConflictHandlerOutput<RxDocType>>;\n\nexport type RxConflictResultionTask<RxDocType> = {\n    /**\n     * Unique id for that single task.\n     */\n    id: string;\n    /**\n     * Tasks must have a context\n     * which makes it easy to filter/identify them again\n     * with plugins or other hacky stuff.\n     */\n    context: string;\n    input: RxConflictHandlerInput<RxDocType>;\n};\n\n\nexport type RxConflictResultionTaskSolution<RxDocType> = {\n    /**\n     * Id of the RxConflictResultionTask\n     */\n    id: string;\n    output: RxConflictHandlerOutput<RxDocType>;\n};\n"],"mappings":"","ignoreList":[]}